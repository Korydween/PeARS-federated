<!--
SPDX-FileCopyrightText: 2022 PeARS Project, <community@pearsproject.org>, 

SPDX-License-Identifier: AGPL-3.0-only
-->

{% extends "base/base.html" %}
{% block navbar_toggler %}
{% endblock %}
{%block navbar_links %}
{% endblock %}
{% block searchbox %}
<form class="form-inline my-2 my-lg-0 mx-2" action="{{url_for('.index')}}" id="searchform">
  <div class="input-group group">
    <input required class="form-control" type="search" value={{query|safe}} aria-label="Search" name="q">
    <button class="btn btn-outline-success" type="submit" id="searchbutton">{{gettext('Search')}}</button>
    <button class="btn btn-outline-success" type="button" id="loadingbutton" style='display:none'>
      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        {{gettext('Searching...')}}
    </button>
  </div>
</form>
{% endblock %}
{% block body %}
<!-- Page Content -->
<div id="page-content-wrapper">
  <div class="container">
    <div class="row">
      <div class="col-md-10">
        {% for result in results %}
        <div class="card mt-2">
          <div class="card-body">
	  <!--<h4 class="card-title"><a href="{{result[1]}}">{{result[2]}}</a></h4>-->
	    <a class="btn btn-light" href="{{result[1]}}"><b>{{result[2]}}</b></a>

            {% if result[5] != None %}
	    <button class="btn btn-link collapsed" data-bs-toggle="collapse" data-bs-target="#collapse{{result[0]}}" aria-expanded="false" aria-controls="collapse{{result[0]}}">
	    <img src="{{ url_for('static', filename='note.png')}}" width='30px' />
            </button>
	    {% endif %}

	    <p class="card-text small" style='margin: 0px 0px 10px 40px'><br>{{result[3]|safe}} ...</p>
	    <p class="small" style='margin-left:40px;'>
	    <a href="{{result[1]}}" class="card-link">{{result[1]}}</a> |
            {% if result[9] != '' %}
	    <a class="results-emoji" href="#" data-toggle="tooltip" title="{{gettext('Trigger warning')}}">🔥</a> {{result[9]}} | 
	    {% endif %}
	    <a class="p-2" href="{{url_for('orchard.report')}}?url={{result[1]}}">{{gettext('Report this entry')}}</a> | 
	    {% if current_user.is_authenticated and current_user.is_confirmed %}
	    <a href="{{url_for('orchard.annotate')}}?url={{result[1]}}" data-toggle="tooltip" title="{{gettext('Add a note to this entry')}}"><span class="results-emoji">🖊️ </span></a> | 
	    {% endif %}
	    </p>
          </div>
          {% if result[5] != None %}
            <div class="card card-body">
              <div class="collapse" id="collapse{{result[0]}}">
              {{result[5]|safe}}
              </div>
            </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      <div class="col-sm-2 d-none d-md-block">
        {% if internal_message %}
        <div id="sidebar-wrapper">
          <div class="alert alert-info alert-dismissible">
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            {{internal_message|safe}}
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<!-- /#page-content-wrapper -->
<script src="{{ url_for('static', filename='js/bootstrap.min.js')}}"></script>
<script src="{{ url_for('static', filename='js/loading.js')}}"></script>
<script>
$(document).ready(function(){
  $('[data-toggle="tooltip"]').tooltip();
});
</script>
{% endblock %}
